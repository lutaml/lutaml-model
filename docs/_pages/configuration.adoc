---
title: Configuration
nav_order: 8
parent: Core Topics
---

= Configuration

== Overview

Lutaml::Model uses an adapter pattern to support multiple serialization libraries. You must configure which adapters to use for each format.

== Basic configuration

Use `Lutaml::Model::Config.configure` to set adapters:

[source,ruby]
----
require 'lutaml/model'

Lutaml::Model::Config.configure do |config|
  config.xml_adapter_type = :nokogiri
  config.json_adapter_type = :standard_json
  config.yaml_adapter_type = :standard_yaml
  config.toml_adapter_type = :toml_rb
  config.hash_adapter_type = :standard_hash
end
----

== Available adapters

=== XML adapters

[cols="1,3",options="header"]
|===
| Adapter | Description

| `:nokogiri` (default)
| Most compatible, based on libxml2. Requires native extensions.

| `:ox`
| Fastest performance. Native C extensions.

| `:oga`
| Pure Ruby. No compilation needed. Opal-compatible.
|===

=== JSON adapters

[cols="1,3",options="header"]
|===
| Adapter | Description

| `:standard_json` (default)
| Ruby standard library. No extra gems needed.

| `:multi_json`
| Common interface wrapper for multiple JSON libraries.

| `:oj`
| Fast C-based parser. Excellent performance.
|===

=== YAML adapter

[cols="1,3",options="header"]
|===
| Adapter | Description

| `:standard_yaml` (default)
| Psych (Ruby standard library). No extra gems needed.
|===

=== TOML adapters

[cols="1,3",options="header"]
|===
| Adapter | Description

| `:toml_rb` (default)
| Pure Ruby. TOML v1.0.0 compatible.

| `:tomlib`
| Enhanced fork. ⚠️ Can segfault on Windows with Ruby < 3.3 on invalid input.
|===

== Configuration with class references

For advanced use, specify adapter classes directly:

[source,ruby]
----
require 'lutaml/model'
require 'lutaml/model/xml/nokogiri_adapter'
require 'lutaml/model/json/standard_adapter'
require 'lutaml/model/yaml/standard_adapter'
require 'lutaml/model/toml/toml_rb_adapter'

Lutaml::Model::Config.configure do |config|
  config.xml_adapter = Lutaml::Model::Xml::NokogiriAdapter
  config.json_adapter = Lutaml::Model::Json::StandardAdapter
  config.yaml_adapter = Lutaml::Model::Yaml::StandardAdapter
  config.toml_adapter = Lutaml::Model::Toml::TomlRbAdapter
end
----

== Default configuration

If not configured, Lutaml::Model uses these defaults:

* YAML: `:standard_yaml`
* JSON: `:standard_json`
* Hash: `:standard_hash`
* XML: not defined (must be configured)
* TOML: not defined (must be configured)

== When to configure

Configure adapters in one of these locations:

For applications:: In an initializer or early-loading file

For gems:: Let end users configure adapters (document the requirement)

For testing:: In `spec_helper.rb` or test setup

.RSpec configuration example
[example]
====
[source,ruby]
----
# spec/spec_helper.rb
require 'lutaml/model'

Lutaml::Model::Config.configure do |config|
  config.xml_adapter_type = :nokogiri
  config.json_adapter_type = :standard_json
  config.yaml_adapter_type = :standard_yaml
  config.toml_adapter_type = :toml_rb
end
----
====

== Adapter selection guide

=== Choose XML adapter based on

* **Nokogiri**: Most projects (default, best compatibility)
* **Ox**: Performance-critical applications
* **Oga**: Pure Ruby environments, Opal/JavaScript compilation

=== Choose JSON adapter based on

* **Standard JSON**: Most projects (default, built-in)
* **Oj**: High-performance requirements
* **MultiJson**: Legacy codebases using MultiJson

=== Choose TOML adapter based on

* **TomlRb**: Most projects (default, pure Ruby)
* **Tomlib**: Additional features needed (beware Windows issues)

== See also

* link:serialization_adapters[Serialization Adapters Reference]
* link:../references/custom_adapters[Creating Custom Adapters]